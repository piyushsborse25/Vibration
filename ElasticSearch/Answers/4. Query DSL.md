---

## **4. Query DSL (Q16–Q20)**

---

**16. Difference between `term` query and `match` query.**

- **Answer:**
    
    - **`term`**: Exact match, no analysis. Best for `keyword` fields.
        
    - **`match`**: Analyzes the input text, tokenizes, then searches. Best for `text` fields.
        
- **Pitfall Note:** Using `term` on a `text` field usually returns no results because the stored tokens differ from the raw string.
    

---

**17. How does the relevance score work in Elasticsearch?**

- **Answer:**
    
    - By default, ES uses **BM25** scoring (improved TF-IDF).
        
    - Factors: term frequency (TF), inverse document frequency (IDF), and field length normalization.
        
- **Pitfall Note:** Filters (`filter` context) do not affect score — they’re cached and used for binary matches.
    

---

**18. What’s the role of `filter` context in a bool query?**

- **Answer:**
    
    - Executes without scoring, just matching.
        
    - Results are cached, improving performance for repeated queries.
        
- **Pitfall Note:** Don’t use `must` for filters when score is irrelevant — it wastes CPU on scoring calculations.
    

---

**19. Difference between `must`, `should`, and `must_not` clauses in a bool query.**

- **Answer:**
    
    - `must`: All conditions must match (contributes to score).
        
    - `should`: Optional matches; can boost relevance or set `minimum_should_match`.
        
    - `must_not`: Must not match (acts like a filter).
        
- **Pitfall Note:** If there are no `must` clauses, at least one `should` must match unless `minimum_should_match` is set to 0.
    

---

**20. How does fuzzy matching work, and what is the `fuzziness` parameter?**

- **Answer:**
    
    - Allows matching terms that differ in spelling using **Levenshtein edit distance**.
        
    - `fuzziness: 1` allows one character change; `AUTO` adjusts based on term length.
        
- **Pitfall Note:** Fuzzy search is slower, especially on large datasets — avoid on high-traffic endpoints without constraints.
    

---